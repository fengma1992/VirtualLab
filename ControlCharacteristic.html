<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>典型环节控制特性分析</title>
    <link rel="stylesheet" href="css/main.css">
</head>
<body>
<div class="mainDiv">
    <div>
        <canvas id="inputCanvas" width="1000" height="300"></canvas>
        <canvas id="outputCanvas" width="1000" height="300"></canvas>
    </div>
    <div class="rowFlexDiv">
        <canvas id="signalCanvas" width="30" height="30"></canvas>
        <button class="normalBtn" onclick="setType(1)">比例</button>
        <button class="normalBtn" onclick="setType(2)">积分</button>
        <button class="normalBtn" onclick="setType(3)">微分</button>
        <button class="normalBtn" onclick="setType(4)">惯性</button>
        <button class="normalBtn" onclick="setType(5)">震荡</button>
        <button class="normalBtn" onclick="setType(6)">比例积分</button>
        <button class="normalBtn" onclick="setType(7)">比例惯性</button>
        <button class="normalBtn" onclick="setType(8)">比例微分</button>
    </div>
</div>
<script src="js/VILibraries/WaveVI.js"></script>
<script src="js/VILibraries/StepResponseGeneratorVI.js"></script>
<script>
    var inputCanvas = document.getElementById('inputCanvas');
    var outputCanvas = document.getElementById('outputCanvas');
    var signalCanvas = document.getElementById('signalCanvas');

    var inputWave = new WaveVI(inputCanvas);
    var outputWave = new WaveVI(outputCanvas);
    var signalGenerator = new StepResponseGeneratorVI(signalCanvas);

    var input = [], signalType = 1;
    for (var i = 0; i < 1024; i++)
        input[i] = 800;

    function setType(type) {

        reset();
        signalType = type;

        switch (signalType) {

            case 1://比例
                signalGenerator.setType(1);
                signalGenerator.k1 = 1.5;
                break;

            case 2://积分
                signalGenerator.setType(2);
                signalGenerator.k2 = 5;
                break;

            case 3://微分
                signalGenerator.setType(3);
                signalGenerator.k3 = 0.0025;
                break;

            case 4://惯性
                signalGenerator.setType(6);
                signalGenerator.k1 = 0.025;
                break;

            case 5://震荡
                signalGenerator.setType(7);
                signalGenerator.k1 = 50;
                signalGenerator.k2 = 0.05;
                break;

            case 6://比例积分
                signalGenerator.setType(4);
                break;

            case 7://比例惯性
                signalGenerator.setType(8);
                signalGenerator.k1 = 0.025;
                signalGenerator.k2 = 1;
                break;

            case 8://比例微分
                signalGenerator.setType(5);
                break;

            default:
                signalGenerator.setType(1);
                signalGenerator.k1 = 1.5;
                break;
        }
        window.setInterval(onTimer, 30);
    }

    function onTimer() {

        signalGenerator.setData(800);
        outputWave.SetData(signalGenerator.output, 1024);
        inputWave.SetData(input, 1024);
    }

    function reset() {

        signalGenerator.reset();
    }
</script>

</body>
</html>